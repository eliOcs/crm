#!/usr/bin/env bash
set -e

echo "Running pre-commit checks..."

# Run Rubocop for linting (auto-fix and re-stage)
echo "=> Running Rubocop..."
bin/rubocop --force-exclusion -A
git add -u

# Security scans
echo "=> Running Brakeman security scan..."
bin/brakeman --no-pager -q

echo "=> Running bundler-audit..."
bin/bundler-audit --quiet

echo "=> Running importmap audit..."
bin/importmap audit

# Run tests
echo "=> Running tests..."
bin/rails test

echo "All checks passed!"
