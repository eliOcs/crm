<div class="page-header">
  <h1 class="page-header__title"><%= t("emails.title") %></h1>
  <span class="page-header__subtitle txt-muted"><%= t("emails.total", count: @total) %></span>
</div>

<% if @emails.any? %>
  <div class="table-responsive">
    <table class="table table--hover">
      <thead>
        <tr>
          <th><%= t("emails.fields.from") %></th>
          <th><%= t("emails.fields.subject") %></th>
          <th><%= t("emails.fields.date") %></th>
          <th class="txt-end"><%= t("emails.fields.attachments") %></th>
        </tr>
      </thead>
      <tbody>
        <% @emails.each do |email| %>
          <tr>
            <td>
              <%= link_to email_path(email[:encoded_path]) do %>
                <%= email.dig(:from, :name).presence || email.dig(:from, :email) || t("emails.unknown") %>
              <% end %>
            </td>
            <td class="txt-sm"><%= email[:subject].presence || t("emails.no_subject") %></td>
            <td class="txt-sm txt-nowrap txt-subtle"><%= email[:date]&.strftime("%Y-%m-%d %H:%M") %></td>
            <td class="txt-end txt-sm"><%= email[:attachments].any? { |a| !a[:inline] } ? t("emails.yes") : "" %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <div class="pagination">
    <span class="pagination__info"><%= t("pagination.page", current: @page, total: @total_pages) %></span>
    <nav class="pagination__nav">
      <% if @page > 1 %>
        <%= link_to t("pagination.previous"), emails_path(page: @page - 1), class: "pagination__link pagination__link--prev" %>
      <% end %>
      <% if @page < @total_pages %>
        <%= link_to t("pagination.next"), emails_path(page: @page + 1), class: "pagination__link pagination__link--next" %>
      <% end %>
    </nav>
  </div>
<% else %>
  <div class="empty-state">
    <p class="empty-state__message"><%= t("emails.empty") %></p>
  </div>
<% end %>
